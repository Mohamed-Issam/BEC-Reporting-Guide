<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BEC Reporting System – Power BI Development Guide</title>
  <style>
    :root{
      --brand:#1f6feb;           /* primary brand blue */
      --brand-600:#1a5bcc;
      --brand-700:#174aa8;
      --brand-50:#e9f1ff;
      --accent:#00b3a4;          /* teal accent */
      --danger:#d73a49;          /* limited red for warnings */
      --ink:#0f172a;             /* slate-900 */
      --muted:#334155;           /* slate-700 */
      --bg:#0b1020;              /* deep background for header/hero */
      --surface:#0f172a;         /* card background */
      --card:#0b132b;            /* darker card */
      --soft:#111827;            /* soft gray */
      --white:#ffffff;
    }
    html, body{
      margin:0; padding:0; color:#e5e7eb; background:#0a0f1f;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      line-height:1.6;
    }
    /* Utility */
    .container{ max-width:1100px; margin:0 auto; padding:0 20px; }
    .hero{
      background: radial-gradient(1200px 600px at 10% -10%, rgba(31,111,235,.25), transparent 60%),
                  radial-gradient(800px 400px at 90% -20%, rgba(0,179,164,.18), transparent 60%),
                  linear-gradient(180deg, #0a0f1f, #0b132b);
      padding:64px 0 40px;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .title{
      font-size:clamp(28px, 5vw, 48px);
      font-weight:800; letter-spacing:.3px; color:#fff; margin:0 0 10px;
    }
    .subtitle{
      color:#cbd5e1; font-size:clamp(14px, 2.2vw, 18px); margin-top:8px; max-width:780px;
    }
    .badge{
      display:inline-block; padding:6px 10px; border:1px solid rgba(255,255,255,.15);
      border-radius:999px; color:#e2e8f0; background:rgba(255,255,255,.03);
      font-size:12px; letter-spacing:.3px; text-transform:uppercase;
    }
    .toc{
      margin-top:28px; display:grid; gap:10px; grid-template-columns:repeat(auto-fit, minmax(150px,1fr));
    }
    .toc a{
      text-decoration:none; color:#e5e7eb; background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08); padding:14px 16px; border-radius:16px; display:flex; gap:12px; align-items:center; vertical-align: middle; justify-content: center; justify-content: center;
    }
    .toc a:hover{ border-color: rgba(255,255,255,.18); transform: translateY(-1px); transition: all .15s ease; }
    .toc svg{ flex:0 0 22px; opacity:.9 }
    main{ padding:40px 0 80px; }
    section{
      margin:28px 0 42px; background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0));
      border:1px solid rgba(255,255,255,.06); border-radius:20px; overflow:hidden;
    }
    .section-hd{
      padding:18px 20px; background:linear-gradient(180deg, rgba(31,111,235,.15), rgba(31,111,235,.08));
      border-bottom:1px solid rgba(255,255,255,.08);
      display:flex; align-items:center; gap:12px;
    }
    .section-hd h2{ margin:0; font-size:22px; letter-spacing:.2px; }
    .section-body{ padding:20px; }
    h3{ margin:16px 0 8px; font-size:18px; color:#e8edf7 }
    p{ margin:8px 0 12px; color:#cbd5e1 }
    ul{ margin:8px 0 12px 18px }
    li{ margin:6px 0 }
    .grid{ display:grid; gap:16px; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
      border:1px solid rgba(255,255,255,.06); border-radius:16px; padding:16px;
    }
    .card.full {
      grid-column: 1 / -1; /* stretch across all grid columns */
      margin-top: 24px;
      }
    .tag{ display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px; background:rgba(31,111,235,.18); color:#dbeafe; border:1px solid rgba(31,111,235,.35) }
    .kbd{ font-family: ui-monospace, Menlo, Consolas, monospace; font-size:12px; background:#0b1020; padding:2px 6px; border-radius:6px; border:1px solid rgba(255,255,255,.07) }
    .note{ border-left:4px solid var(--accent); padding:10px 14px; background:rgba(0,179,164,.08); border-radius:10px }
    .warn{ border-left:4px solid var(--danger); padding:10px 14px; background:rgba(215,58,73,.08); border-radius:10px }
    .mono{ font-family: ui-monospace, Menlo, Consolas, monospace; }
    .figure{ background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01)); border:1px dashed rgba(255,255,255,.12);
             padding:14px; border-radius:14px; }
    .figure img{ max-width:100%; width:100%; height:auto; display:block; border-radius:10px }
    .caption{ font-size:12px; color:#93a5bf; margin-top:8px }
    table{ width:100%; border-collapse:collapse; margin:10px 0; }
    th, td{ padding:10px; border-bottom:1px solid rgba(255,255,255,.08); font-size:14px; }
    th{ text-align:left; color:#e5e7eb; background:rgba(255,255,255,.03) }
    .palette{ display:flex; gap:10px; flex-wrap:wrap; margin:6px 0 }
    .swatch{ width:56px; height:28px; border-radius:8px; border:1px solid rgba(255,255,255,.14); display:flex; align-items:center; justify-content:center; font-size:10px }
    .footer{ text-align:center; color:#93a5bf; padding:24px 0; border-top:1px solid rgba(255,255,255,.06) }
    a{ color:#8ec5ff }
    .backtop{ text-align:right; margin-top:8px; }
    .pill{ display:inline-block; padding:3px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.14); font-size:12px; color:#c9d4eb }
    .hero .container{ position:relative; padding-top:140px; }
    .logo-link{ position:absolute; top:5px; left:20px; display:inline-block; }
    .logo-link img{ height:120px; width:auto; opacity:.95; }
        .logo-link:hover img{ opacity:1; transform:scale(1.02); transition: all .15s ease; }
    .img-center{ display:block; margin-left:auto; margin-right:auto; }
    
    /* Modal/Lightbox Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      backdrop-filter: blur(4px);
    }
    
         .modal-content {
       margin: auto;
       display: block;
       max-width: 90%;
       max-height: 90%;
       position: absolute;
       top: 50%;
       left: 50%;
       transform: translate(-50%, -50%);
       border-radius: 12px;
       box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
       /* Prevent any hover effects on the modal image */
       transition: none !important;
       transform: translate(-50%, -50%) !important;
     }
     
     /* Ensure modal image never gets hover effects */
     .modal-content:hover {
       transform: translate(-50%, -50%) !important;
       box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5) !important;
     }
    
    .close {
      position: absolute;
      top: 15px;
      right: 35px;
      color: #f1f1f1;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1001;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .close:hover,
    .close:focus {
      color: #bbb;
      text-decoration: none;
      background: rgba(0, 0, 0, 0.7);
    }
    
         /* Make images clickable */
     .clickable-image {
       cursor: pointer;
       transition: box-shadow 0.25s ease;
     }
     
     .clickable-image:hover {
       box-shadow:
         0 0 14px 2px rgba(31,111,235,0.45),
         0 0 28px 10px rgba(0,179,164,0.25);
     }
     
     /* Disable hover effects when modal is open */
     .modal-open .clickable-image:hover {
       box-shadow: none;
     }
     
     /* Ensure modal image never gets clickable-image styles */
     #modalImage {
       cursor: default !important;
       transition: none !important;
     }
     
     #modalImage:hover {
       transform: translate(-50%, -50%) !important;
       box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5) !important;
     }
    
    /* Hover GIF flip animation */
    .hover-gif {
      transition: transform .6s ease;
      transform-style: preserve-3d;
    }
    .gif-flip-once {
      animation: gifFlip .8s ease;
    }
    @keyframes gifFlip {
      0% { transform: rotateY(0deg); }
      50% { transform: rotateY(180deg); }
      100% { transform: rotateY(360deg); }
    }
    
    /* Loading animation for modal */
    .modal-loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 18px;
    }
    html { scroll-behavior: smooth; }
    
    /* Ensure page starts at top */
    body { scroll-behavior: auto; }

    /* Workflow Illustration */
    .workflow-steps {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: space-between;
      text-align: center;
    }
    .workflow-steps .step {
      flex: 1 1 200px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.01));
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 16px;
      padding: 20px;
      transition: transform .2s;
    }
    .workflow-steps .step:hover {
      transform: translateY(-4px);
    }
    .workflow-steps .step svg {
      margin-bottom: 10px;
      opacity: .85;
    }

    /* Accordion Styles */
    .accordion { border-radius: 12px; overflow: hidden; margin-top: 16px; }
    .accordion-item { border-bottom: 1px solid rgba(255,255,255,.08); }
    .accordion-header {
      background: rgba(255,255,255,.03);
      cursor: pointer;
      padding: 14px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background .2s;
    }
    .accordion-header:hover { background: rgba(255,255,255,.06); }
    .accordion-header h3 { margin: 0; font-size: 16px; }
    .accordion-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height .4s ease, padding .3s ease;
      padding: 0 16px;
    }
    .accordion-content.open { padding: 16px; }

    /* Nested Accordion Styles */
    .nested-accordion {
      margin: 12px 0;
      border: 1px solid rgba(255,255,255,.06);
      border-radius: 8px;
      overflow: hidden;
    }
    .nested-accordion-item {
      border-bottom: 1px solid rgba(255,255,255,.04);
    }
    .nested-accordion-item:last-child {
      border-bottom: none;
    }
    .nested-accordion-header {
      background: rgba(255,255,255,.08);
      cursor: pointer;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background .2s;
      font-weight: 600;
      color: #f1f5f9;
      border-left: 3px solid rgba(31,111,235,.3);
    }
    .nested-accordion-header:hover {
      background: rgba(255,255,255,.12);
      border-left-color: rgba(31,111,235,.5);
    }
    .nested-accordion-header h4 {
      margin: 0;
      font-size: 14px;
      font-weight: 600;
    }
    .nested-accordion-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height .3s ease, padding .2s ease;
      padding: 0 16px;
      background: rgba(255,255,255,.01);
    }
    .nested-accordion-content.open { padding: 16px; }
    .nested-accordion-content ol {
      margin: 8px 0;
      padding-left: 20px;
    }
    .nested-accordion-content li {
      margin: 6px 0;
      color: #cbd5e1;
    }

    /* Timeline */
    .timeline {
      position: relative;
      margin: 20px 0;
      padding-left: 20px;
    }
    .timeline::before {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      left: 8px;
      width: 2px;
      background: var(--brand);
    }
    .timeline-step {
      position: relative;
      margin-bottom: 20px;
      padding-left: 30px;
    }
    .timeline-step::before {
      content: "";
      position: absolute;
      left: 0;
      top: 4px;
      width: 14px;
      height: 14px;
      background: var(--brand);
      border-radius: 50%;
    }

    /* Back to Top Button */
    .backtop-btn {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--brand);
      color: white;
      border: none;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      cursor: pointer;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,.4);
      opacity: 0.8;
      transition: opacity .3s, transform .2s;
      z-index: 999;
    }
    .backtop-btn:hover {
      opacity: 1;
      transform: translateY(-3px);
    }

    /* Expand/Collapse All Buttons */
    .accordion-controls {
      position: fixed;
      top: 50%;
      right: 24px;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 998;
    }
    .accordion-control-btn {
      background: var(--brand);
      color: white;
      border: none;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      cursor: pointer;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0,0,0,.4);
      opacity: 0.8;
      transition: opacity .3s, transform .2s;
    }
    .accordion-control-btn:hover {
      opacity: 1;
      transform: translateY(-3px);
    }
    .report-meta {
            margin: 8px 0 0 0;
            padding-left: 0;
            list-style: none;
            font-size: 15px;
            color: #8ec5ff;
          }
          .report-meta li {
            margin: 2px 0;
            padding: 0;
            display: flex;
            align-items: center;
            gap: 8px;
          }
          .report-label {
            display: inline-block;
            min-width: 80px;
            font-weight: 600;
            color: #38bdf8;
            background: rgba(31,111,235,0.10);
            border-radius: 6px;
            padding: 2px 8px;
            font-size: 13px;
            margin-right: 6px;
            min-height: 40px;
            vertical-align: middle;
            align-items: center;
            justify-content: center;
            justify-items: center;
            align-content: center;
          }
          .report-examples {
            color: #a5f3fc;
            font-family: ui-monospace, Menlo, Consolas, monospace;
            font-size: 14px;
            background: rgba(0,179,164,0.08);
            border-radius: 6px;
            padding: 2px 8px;
            margin-left: 2px;
          }
          /* Analytics Illustration */
          .analytics-illustration {
            width: 100%;
            display: block;
            margin: 8px 0 4px 0;
          }
          .analytics-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 8px 12px;
            margin-top: 8px;
            color: #cbd5e1;
            font-size: 13px;
          }
          .analytics-legend .item {
            display: flex;
            align-items: center;
            gap: 8px;
          }
          .analytics-badge {
            display: inline-block;
            min-width: 18px;
            height: 18px;
            border-radius: 4px;
          }
          /* Numbered meta list with aligned labels */
          .report-meta.numbered { counter-reset: step; padding-left: 0; list-style: none; }
          .report-meta.numbered li { display: flex; align-items: flex-start; gap: 8px; margin: 6px 0; }
          .report-meta.numbered li::before {
            counter-increment: step;
            content: counter(step) ".";
            color: #93a5bf;
            width: 20px;
            flex: 0 0 20px;
            text-align: right;
            margin-right: 4px;
          }
          .report-meta.numbered .report-label { min-width: 220px; }
          /* Folder structure card + table styling */
          .folder-structure-card {
            padding: 14px;
            border: 1px solid rgba(255,255,255,.08);
            border-radius: 12px;
            background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));
            box-shadow: 0 6px 18px rgba(0,0,0,.25);
            margin-top: 8px;
          }
          .folder-structure-card .card-title {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #cbd5e1;
          }
          .folder-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            overflow: hidden;
            border-radius: 10px;
          }
          .folder-table th, .folder-table td {
            padding: 10px 12px;
            border-bottom: 1px solid rgba(255,255,255,.08);
            font-size: 14px;
          }
          .folder-table th {
            text-align: left;
            color: #e5e7eb;
            background: rgba(255,255,255,.06);
            letter-spacing: .2px;
          }
          .folder-table td.level-cell {
            color: #dbeafe;
            font-weight: 600;
          }
          .folder-table td.path-cell {
            color: #a5f3fc;
            font-family: ui-monospace, Menlo, Consolas, monospace;
            background: rgba(0,179,164,0.06);
          }
          .section-divider {
            height: 1px;
            border: 0;
            background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.22), rgba(255,255,255,0));
            margin: 16px 0;
          }
          /* Inline album */
          .inline-album {
            position: relative;
            background: transparent;
            border: 1px solid rgba(255,255,255,.08);
            border-radius: 12px;
            padding: 10px 44px;
            margin: 8px 0 4px 0;
          }
          .album-viewport {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            background: transparent;
            border-radius: 8px;
            overflow: hidden;
          }
          .album-slide { display: none; margin: 0; width: 100%; height: 100%; position: absolute; inset: 0; }
          .album-slide.active { display: block; }
          .album-slide img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
            border-radius: 6px;
            padding: 8px; /* inner margin inside viewport */
          }
          .album-caption { display:none; font-size: 12px; color: #93a5bf; padding: 8px 2px 2px 2px; }
          .album-caption-display { font-size: 12px; color: #93a5bf; margin-top: 6px; }
          .album-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,.14);
            background: rgba(15,23,42,.6);
            color: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background .2s, transform .1s;
            user-select: none;
          }
          .album-nav:hover { background: rgba(15,23,42,.8); }
          .album-nav:active { transform: translateY(-50%) scale(.96); }
          .album-nav.prev { left: 8px; }
          .album-nav.next { right: 8px; }

          .stage-desc {
            font-size: 0.95rem;   /* adjust size */
            color: #64748b;       /* soft gray-blue */
            margin: 6px 0 12px;   /* spacing */
            margin-left: 25px;
            line-height: 1.5;     /* readability */
          }
  </style>
</head>
<body>
  <!-- Hero -->
  <header class="hero">
    <div class="container">
      <a href="#" class="logo-link">
        <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EfGIQO9M8khFtcTu4et3g_oBrbAaVuS8IU3bC9bMne2WjA?download=1" alt="Logo">
      </a>
      <span class="badge">Prepared by Project Controls Intelligence - Project Controls Department</span>
      <h1 class="title">BEC Reporting System</h1>
      <p class="subtitle">A practical, visual checklist for designing, modeling, securing, and publishing high‑quality dashboards adhereing to BEC best practices. Use this as your standard operating procedure for all dashboards.
      </p>
      <!-- Quick Links -->
      <div class="toc"; style="text-align: center">
        <a href="#purpose"><span>1. Purpose</span></a>
        <a href="#audience"><span>2. Audience</span></a>
        <a href="#system"><span>3. Reporting System</span></a>
        <a href="#workflow"><span>4. Workflow & Responsibility (RACI)</span></a>
        <a href="#checklist"><span>5. Quality Checklist</span></a>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Purpose -->
    <section id="purpose">
      <div class="section-hd">
        <h2>1) Purpose</h2>
        <span class="pill">Standardization • Roles • Transparency</span>
      </div>
      <div class="section-body">
        <ol>
          <li>Standardized Dashboard Development & Reporting.</li>
          <li>Establish unified procedures for developing and publishing all official dashboards.</li>
          <li>Department Roles: Clearly define and highlight responsibilities across all departments.</li>
          <li>Current System: Showcase existing reporting structure for transparency and alignment.</li>
          <li>Foundation & Workflow: Build standardized processes in line with BEC standards and requirements.</li>
        </ol>
      </div>
    </section>

    <!-- Audience -->
    <section id="audience">
      <div class="section-hd">
        <h2>2) Audience</h2>
        <span class="pill">Teams • Developers • Decision Makers</span>
      </div>
      <div class="section-body">
        <p>This guide is designed for individuals seeking to understand BEC’s current reporting system, as well as those interested in developing BI reports that meet their departmental needs while remaining fully aligned with the company’s standards.</p>
      </div>
    </section>

    <!-- Reporting System -->
    <section id="system">
      <div class="section-hd">
        <h2>3) BEC Current Reporting System</h2>
        <span class="pill">Technical • Business Technology</span>
      </div>
      <div class="section-body">
        <div class="card">
          <p>Currently we have 2 departments developing and publishing Power BI reports as highlighted in the organization chart below: </p>
          <div class="figure">
            <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EdEKA4WbpsdJlo-7Al-A_tAB6nmRgZ07F-0Wj5i4bpmABA?Download=1" alt="Organization Chart">
          </div>
          <p>Stakeholders include: CEO, Project Director, Controls Director, Operations, HR, Finance, PCS, Environment, HSE, Cost, Planning, Reporting Team (PCI), Business Development, Finance, and IT.</p>
        </div>
      </div>
      <div class="section-body">
          <div class="card">
            <p><strong>Purpose:</strong> Help teams understand the reporting system and build BI reports that meet departmental needs while aligning with company standards.</p>
            <ol>
              <li>
                <strong>Technical Reports</strong>
                <ul class="report-meta">
                  <li><span class="report-label">Produced by</span>PCI with SMEs</li>
                  <li><span class="report-label">Focus</span>Project/functional needs</li>
                  <li><span class="report-label">Examples</span><span class="report-examples">Procurement, revenue tracking, cost reports</span></li>
                </ul>
              </li>
              <li>
                <strong>Business Technology Reports (Non Technical)</strong>
                <ul class="report-meta">
                  <li><span class="report-label">Produced by</span>IT</li>
                  <li><span class="report-label">Focus</span>Platform-wide views</li>
                  <li><span class="report-label">Examples</span><span class="report-examples">Inventory, cross-department dashboards</span></li>
                </ul>
              </li>
            </ol>
          </div>
        </div>
        <div class="section-body">
          <div class="card">
            <div id="workspaces-reference"></div>
            <p><strong>Accessibility and Available Portals:</strong> Power BI dashboards are stored in workspaces and can be viewed from an All in One Dashboard containing links to all other dashboards.</p>
            <ul>
              <li><strong>Power BI Workspaces:</strong> A centralized environment where dashboards, reports, and datasets are stored, shared, and collaboratively managed. Can be thought of as the backend environment</li>
              <li>We have 2 existing workspaces right now, PCI Workspace maintained by Project Controls Intelligence Team and Consolidation BI maintained by Business Technology</li>
              <div class="grid">
                <div class="card">
                  <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EZkCaI5d0BNDhUP08jXpLW8BjeGGsr_bvYxkRRPF_rYSKw?download=1" alt="PCI Workspace" style="width:100%;height:auto;border-radius:10px;display:block;">
                  <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">PCI Workspace</p>
                </div>
                <div class="card">
                  <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EUTo8eOqUtRHiNJQXXL649cBC7G7EztUZiLcvcpOe_A-Dg?download=1" alt="Business Technology Workspace" style="width:100%;height:auto;border-radius:10px;display:block;">
                  <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">Business Technology Workspace (Consolidation BI)</p>
                </div>
              </div>
              <li><strong>All in One Dashboard:</strong> A dashboard stored in the workspace that is housing links to all the other dashboards in the workspace. Can be thought of as a front end UI to navigate the workspace.</li>
              <li>Currently we have 2 Consolidation Dashboards for each department</li>
              <div class="grid">
                <div class="card">
                  <img class="hover-gif" data-gif-src="https://github.com/Mohamed-Issam/BEC-Reporting-Guide/blob/main/Assets/PCI%20All%20in%20One.gif?raw=true" src="https://github.com/Mohamed-Issam/BEC-Reporting-Guide/blob/main/Assets/PCI%20All%20in%20One.gif?raw=true" alt="PCI All in One Dashboard (GIF)" style="width:100%;height:auto;border-radius:10px;display:block;">
                  <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">PCI All in One Dashboard</p>
                </div>
                <div class="card">
                  <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EbSxnZQy_1dJmU_9lBomr-MBWFSGMBjM7ddbJVpXa2_zWQ?download=1" alt="Business Technology All in One Dashboard" style="width:100%;height:auto;border-radius:10px;display:block;">
                  <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">Business Technology Project Consolidation</p>
                </div>
              </div>
              <li>As of 14/10/2025, we have a final BEC Arabia Dashboard Landing Page</li>
              <div class="grid">
                <div class="card">
                  <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EcBfIMD5PelLqVrToNt3rowB_-jYIgYnaUbmp_EaGNlcOA?download=1" alt="PCI Workspace" style="width:100%;height:auto;border-radius:10px;display:block;">
                  <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">BEC BI Landing Page</p>
                </div>
              </div>
            </ul>
          </div>
        </div>
      </section>

    <!-- Workflow -->
    <section id="workflow">
      <div class="section-hd">
        <h2>4) Dashboard Request, Creation Workflows & Responsibility</h2>
        <span class="pill">Requests • Creation • Development</span>
      </div>

      <div class="section-body">
        <strong>4.1 Requesting a dashboard workflow:</strong>
        
        <div class="stage-desc">
          <p>
            If you require a new dashboard, report, or modification to an existing one,
            please submit a request through our 
            <a href="https://data-dash-central.lovable.app/auth" target="_blank" rel="noopener noreferrer">
              Communications HUB
            </a>.<br>
            Provide the following details to ensure faster processing:
          </p>
          
          <ul>
            <li>Purpose of the report (decision-making, monitoring, compliance, etc.)</li>
            <li>Data source(s) required</li>
            <li>Key KPIs or metrics needed</li>
            <li>Department(s) or projects impacted</li>
          </ul>
        </div>
      
        <p style="margin-left: 25px;">
          Once submitted, the BI team will review your request, validate data availability, and confirm delivery timelines.<br>
        </p>
      
        <div class="card">
          <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EZ16DwMZ9HtJgc71pivGYm4BSp-CxqImXPyW_bnYGL8PNA?download=1" 
               alt="Requesting dashboard workflow" 
               style="width:100%; height:auto; border-radius:10px; display:block;">
          <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">Dashboard Request Workflow</p>
        </div>
      </div>
      <hr class="section-divider">
      <div class="section-body">
        <strong>4.2 Dashboard development goes through 3 major steps:</strong>
        <div class="stage-desc">
          <ol>
            <li>Assessment of Dashboard Requirements</li>
              <p>Such assessment helps understanding what the other are expecting in the dashboard, the kind of information they are looking for, and this required a significant effort to prepare the necessary templates and train the people how the final system is going to work.</p>
            <li>Developing & Feedback</li>
                <p>Once the system is ready and templates are filled, the next step is Report Design. With the dashboard requirements already set, we now focus on building the Data Model that Power BI will use.</p>
            <li>Publishing & Maintaining</li>
                <P>Share the dashboard with users, keep it updated, and handle potential issues such as data problems that may break automatic refresh or require ad-hoc modifications.</P>
          </ol>
        </div>
        <div class="card">
          <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EeNLaKk3PSBIsOnHvYeDZ2ABHqhR4qBIvvpen2UNpdLdjA?download=1" alt="Business Technology All in One Dashboard" style="width:100%;height:auto;border-radius:10px;display:block;">
          <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">Dashboard Creation Stages and RACI Diagram</p>
        </div>
      </div>
    </section>

     <!-- Checklist -->
      <section id="checklist">
        <div class="section-hd">
          <h2>5) Quality Checklist</h2>
          <span class="pill">QC • Development • Publishing</span>
        </div>
        <div class="section-body">
          <p>The Quality Checklist is divided into two major phases:</p>

          <!-- Accordion -->
          <div class="accordion">
            <!-- Report Development -->
            <div class="accordion-item">
              <div class="accordion-header"><h3>1. Report Development</h3><span>+</span></div>
              <div class="accordion-content">
                <div class="nested-accordion">
                  <div class="nested-accordion-item">
                    <div class="nested-accordion-header">
                      <h4>1.1 Data Collection</h4>
                      <span>+</span>
                    </div>
                    <div class="nested-accordion-content">
                      <ol>
                        <li>Data can be gathered from cloud databases or manual files (Excel/CSV) in a standard SharePoint folder.</li>
                        <div class="folder-structure-card">
                          <p class="card-title">Recommended local folder structure</p>
                          <table class="folder-table">
                          <thead>
                            <tr>
                              <th>Level</th>
                              <th>Example</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class="level-cell">Root</td>
                              <td class="path-cell">/Power BI Local Files/</td>
                            </tr>
                            <tr>
                              <td class="level-cell">Project</td>
                              <td class="path-cell">/Power BI Local Files/{Dashboard Name}/</td>
                            </tr>
                            <tr>
                              <td class="level-cell">Project</td>
                              <td class="path-cell">/Power BI Local Files/{Dashboard Name}/Power BI Files/</td>
                            </tr>
                            <tr>
                              <td class="level-cell">Project</td>
                              <td class="path-cell">/Power BI Local Files/{Dashboard Name}/Source Files/</td>
                            </tr>
                            <tr>
                              <td class="level-cell">Project</td>
                              <td class="path-cell">/Power BI Local Files/{Dashboard Name}/Support Files/</td>
                            </tr>
                          </tbody>
                          </table>
                          <p><a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EXKZOqIjt4ZAvfk2E2Z-CUsB_ly7jsAGmaKUHzEeVV5x2w?download=1">View folder structure practical example</a></p>
                        </div>
                        <li>Dashboard file name should follow this naming convention "Dashboad Name - Rev00", and new modifications need to take a new revision like this <a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ES4Ys-nn495Hknw0rvoLG5EB0bHUDQfSO0XsLPh-Yg-cCg?download=1"> See Example</a></li>
                        <li>Excel sheets must be formatted as tables, named like <span class="mono">T_Invoices</span>. <a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EUU8KSqW1oxAjIKGxd2jCywB-cN_yBzEbCYehFI8tDMeFw?download=1">See Example</a></li>
                        <li>The dataset must include a primary key column with distinct, non-duplicate values. For example in the picture above "IPC" can be considered the primary key</li>
                        <li>A SharePoint URL parameter must be defined in the Power BI model.</li>
                        <li>If using cloud databases (Aconex, Azure), contact IT for credentials and optimized views.</li>
                      </ol>
                      <hr class="section-divider">
                      <strong> Steps to connecting to manual excel/csv sheets</strong>
                      <div class="inline-album" data-album>
                        <div class="album-viewport">
                          <div class="album-slide active">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EYekeC35gUtOotje0pQaZPMB-GGCHS9Lqga4BhqKdjTZ8g?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EYekeC35gUtOotje0pQaZPMB-GGCHS9Lqga4BhqKdjTZ8g?download=1" style="width: 93%" alt="Step 1">
                            <div class="album-caption">Step 1: Open Power BI Desktop and click Transform Data to open Power Query</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EX0Fr5hV0bNPpbLhy4kJXnEBBujdxxpgFzVty3WYzvEkhg?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EX0Fr5hV0bNPpbLhy4kJXnEBBujdxxpgFzVty3WYzvEkhg?download=1" style="width: 93%" alt="Step 2">
                            <div class="album-caption">Step 2: Create a new parameter for the root path of your sharepoint folder (Checklist point 4)</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EasitRFyFVZCmZ3JVXFt2i8Bxt1ADT_msJppdVnLGfIBog?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EasitRFyFVZCmZ3JVXFt2i8Bxt1ADT_msJppdVnLGfIBog?download=1" style="width: 93%" alt="Step 3">
                            <div class="album-caption">Step 3: Fill in parameter data and rooth path</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/Ed0FAqBrRx9MvruOhVnWSk8Be-a695WIPGg0C3keGtlFbQ?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/Ed0FAqBrRx9MvruOhVnWSk8Be-a695WIPGg0C3keGtlFbQ?download=1" style="width: 93%" alt="Step 4">
                            <div class="album-caption">Step 4: Connect to Sharepoint Folder through New Data Source</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/Ec4bIOECsvhEo2GEx8THNToBmz38IBBqzHZ7IW5Gd4jq3Q?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/Ec4bIOECsvhEo2GEx8THNToBmz38IBBqzHZ7IW5Gd4jq3Q?download=1" style="width: 93%" alt="Step 5">
                            <div class="album-caption">Step 5: Connect to Sharepoint Folder</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EZX-q3VGWmJOkzRXHm1qXd0BlPImMQWDrpO9q9Skcd3Tdw?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EZX-q3VGWmJOkzRXHm1qXd0BlPImMQWDrpO9q9Skcd3Tdw?download=1" style="width: 93%" alt="Step 6">
                            <div class="album-caption">Step 6: Either type the root path manually or choose the parameter that we just created</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EfUOoRYd6SZAjVVPU8cCUK0BgBbSriz9hobzdWG8Y77Rcw?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EfUOoRYd6SZAjVVPU8cCUK0BgBbSriz9hobzdWG8Y77Rcw?download=1" style="width: 93%" alt="Step 7">
                            <div class="album-caption">Step 7: Click transform data</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EfBPg9pb_shJvbPR0TLNr_UBVZiJZIH8a2dlk7uuwUCrkw?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EfBPg9pb_shJvbPR0TLNr_UBVZiJZIH8a2dlk7uuwUCrkw?download=1" style="width: 93%" alt="Step 8">
                            <div class="album-caption">Step 8: Navigate to Folder Path column in Power Query and filter to get to the desired excel/csv file</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EUPfDj3NHFdOrRizYpdmdakBkb_kWAWQAJyiNhbAymR53Q?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EUPfDj3NHFdOrRizYpdmdakBkb_kWAWQAJyiNhbAymR53Q?download=1" style="width: 93%" alt="Step 9">
                            <div class="album-caption">Step 9: Details on filtering Folder Path column. The search path here is an example and each user might have a different folder structure.</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EQcfZmhvbehIgDtsAYkdIa0BHcfuLx0hga8ZIAju_h70dA?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EQcfZmhvbehIgDtsAYkdIa0BHcfuLx0hga8ZIAju_h70dA?download=1" style="width: 93%" alt="Step 10">
                            <div class="album-caption">Step 10: Add a custom column to extract the contents of the excel/csv file. There are other ways but this is the recommended method. Here we named the new column "Sheet Content"</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EdZZoT_r3YRJszcsyd0tNPcBbpdInkpZ0ponpcWyGxRRWg?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EQkHqodtlmVKrC9abTo0JZQBOsHDpoVLrLASOo2-R9nzrg?download=1" style="width: 93%" alt="Step 11">
                            <div class="album-caption">Step 11: Filter on Data and Kind</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EXq_K54SxsVKpbE-SOGowfQBgZtk8M2rF-9zQNt421OGCg?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EXq_K54SxsVKpbE-SOGowfQBgZtk8M2rF-9zQNt421OGCg?download=1" style="width: 93%" alt="Step 12">
                            <div class="album-caption">Step 12: This only applies for excel sheet since we agreed that any data will be converted to a table in excel, so in this step we filter on tables only underneath the "Kind" column</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EV2KeOQFJrpIp89G0TC-yO0BkIcF46aLML4rEgg0bwxQlA?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EV2KeOQFJrpIp89G0TC-yO0BkIcF46aLML4rEgg0bwxQlA?download=1" style="width: 93%" alt="Step 13">
                            <div class="album-caption">Step 13: Remove unrelated columns</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EQKl1w5WXfdKgE0I7g0u81UBwRWXChPGP2D8et7zXha_Yg?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EQKl1w5WXfdKgE0I7g0u81UBwRWXChPGP2D8et7zXha_Yg?download=1" style="width: 93%" alt="Step 14">
                            <div class="album-caption">Step 14: This step serves as a guide for Checklist point 2 under the "Data Transformation" stage where we extract the date of the file from the name</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ESc1qb38XcBKrUCE5Oz5w9IB46aj6-4gOUCvNRo2CrvX_w?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ESc1qb38XcBKrUCE5Oz5w9IB46aj6-4gOUCvNRo2CrvX_w?download=1" style="width: 93%" alt="Step 15">
                            <div class="album-caption">Step 15: Continue date column data extraction from file name</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ETUS1riSpiJCnCRpUlA8_noBNXIEQbRA6Q960xLJMLyzIw?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ETUS1riSpiJCnCRpUlA8_noBNXIEQbRA6Q960xLJMLyzIw?download=1" style="width: 93%" alt="Step 16">
                            <div class="album-caption">Step 16: Convert column to date after extracting the date data</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EaRH2aPVbz1NpVl5YrFPC9EBvCFlx6VV09NdABl-sapRww?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EaRH2aPVbz1NpVl5YrFPC9EBvCFlx6VV09NdABl-sapRww?download=1" style="width: 93%" alt="Step 17">
                            <div class="album-caption">Step 17: Finally change column name apropiately</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EamZF3p-qCRBq1wu1aptNoUBDmJ-N0ZtoE-DBa1VBKMLbg?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EamZF3p-qCRBq1wu1aptNoUBDmJ-N0ZtoE-DBa1VBKMLbg?download=1" style="width: 93%" alt="Step 18">
                            <div class="album-caption">Step 18: To load the rest of the data, click on the expand button and choose relevant columns</div>
                          </div>
                          <div class="album-slide">
                            <img class="clickable-image open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ET9s2pdhz3ZAp9-Mbuj7MeMBk8mte14ASq6DXef-zXvyuA?download=1" src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ET9s2pdhz3ZAp9-Mbuj7MeMBk8mte14ASq6DXef-zXvyuA?download=1" style="width: 93%" alt="Step 19">
                            <div class="album-caption">Step 19: Final output</div>
                          </div>
                        </div>
                        <div class="album-caption-display"></div>
                        <button class="album-nav prev" aria-label="Previous">&#10094;</button>
                        <button class="album-nav next" aria-label="Next">&#10095;</button>
                      </div>

                    </div>
                  </div>
                  
                  <div class="nested-accordion-item">
                    <div class="nested-accordion-header">
                      <h4>1.2 Data Transformation (Power Query Stage)</h4>
                      <span>+</span>
                    </div>
                    <div class="nested-accordion-content">
                      <ol class="report-meta numbered">
                        <li><span class="report-label">Data Types</span><span class="report-text">Validate and assign correct data types (Text, Number, Date, etc.)</span></li>
                        <li><span class="report-label">Date Column</span><span class="report-text">For manual data sources, add a "Date Refreshed" column that reads from the manual file metadata</span></li>
                        <li><span class="report-label">Null / Missing Values</span><span class="report-text">Identify and handle nulls or missing values appropriately</span></li>
                        <li><span class="report-label">Consistent Formatting</span><span class="report-text">Apply consistent formatting (trim spaces, standardize case (Capetalize, Proper), clean characters). This is important for columns that are used for relations or slicers.</span></li>
                        <li><span class="report-label">Deduplication</span><span class="report-text">Remove duplicate rows based on key fields</span></li>
                        <li><span class="report-label">Filtering</span><span class="report-text">Apply filters to exclude irrelevant rows or categories (Especially blank rows)</span></li>
                        <li><span class="report-label">Merging / Appending</span><span class="report-text">Avoid using merging as it makes the model heavy and slow but either ways ensure merging/appending queries have aligned columns and data types</span></li>
                        <li><span class="report-label">Customized Columns</span><span class="report-text">Create calculated columns with documented logic</span></li>
                        <li><span class="report-label">Error Handling</span><span class="report-text">Detect and resolve errors (invalid data types, failed conversions)</span></li>
                        <li><span class="report-label">Performance Optimization</span><span class="report-text">Remove unused columns and filter early to reduce model size</span></li>
                        <li><span class="report-label">Commenting</span><span class="report-text">Comment steps and group related queries for maintainability</span></li>
                      </ol>
                    </div>
                  </div>
                  
                  <div class="nested-accordion-item">
                    <div class="nested-accordion-header">
                      <h4>1.3 Data Modelling</h4>
                      <span>+</span>
                    </div>
                    <div class="nested-accordion-content">
                      <ol>
                        <li>Use clear, business-friendly names for tables and columns.</li>
                        <li>Add a Master Date Table connected to all others.</li>
                        <li>Identify fact tables (transactions) and dimension tables (attributes).</li>
                        <li>Prefer star schema; avoid snowflake or flat designs.</li>
                        <li>Ensure relationship cardinality matches business logic.</li>
                        <li>Use single-direction relationships unless bi-directional is necessary.</li>
                        <li>Use explicit measures (avoid implicit drag‑and‑drop summarization). <a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EYolzR40AgdDiyXbwB_RGiABWIKT2WdgTZ70raVd27CRiw?download=1">See Example</a></li>
                        <li>Document complex DAX logic with comments.</li>
                        <li>Group all measures in a dedicated table <span class="mono">00-All Measures Grid</span> <a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EYw3xIi8CRxGrckbkY6xJvIBCgPQz04885Ywi5m-9MrZnQ?download=1">See Example</a>.</li>
                        <li>Validate and assign correct data types (Text, Number, Date, etc.)</li>
                        <li>Perform heavy data shaping and transformations in Power Query.</li>
                        <li>Reserve DAX for lightweight calculations, aggregations, and measures.</li>
                        <li>Rule of thumb:  
                          <ul>
                            <li>If transformation produces the same result regardless of report context → do it in Power Query.</li>
                            <li>If it depends on filters or interactions → do it in DAX.</li>
                          </ul>
                        </li>
                      </ol>
                      <hr class="section-divider">
                      <p>The flowing flowchart is a summary for the process discussed above in section 1.1, 1.2, and 1.3:</p>
                      <div class="card">
                        <img src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/ERk_WJwkIlVImcYTXs9-MpABQcaLpbgeuiNj60q9SwPdtw?download=1" alt="Flowchart" style="width:100%;height:auto;border-radius:10px;display:block;">
                        <p style="text-align: center; color: #cbd5e1; margin: 8px 0 0;">Report Development Flowchart</p>
                    </div>
                  </div>
                  
                  <div class="nested-accordion-item">
                    <div class="nested-accordion-header">
                      <h4>1.4 Data Visualizing</h4>
                      <span>+</span>
                    </div>
                    <div class="nested-accordion-content">
                      <ol>
                        <li>Titles at top-left, logo at top-right, filters at top-center.</li>
                        <li>Menu bar with icons for Home, Reset Filters, and Date.</li>
                        <li>Include a landing page with summary, responsible team, last refresh, and navigation.</li>
                        <li>Arrange visuals to guide the user’s eye logically (left-to-right, top-to-bottom).</li>
                        <li>Each report must have at least 2 pages.</li>
                        <li>Use buttons and bookmarks for navigation</li>
                        <li>Only the landing page is visible and the rest is hidden. Landing page must include:</li>
                          <ul>
                            <li>Short summary of dashboard purpose/functions.</li>
                            <li>Responsible person/ream for updates.</li>
                            <li>Last refresh timestamp.</li>
                            <li>A navigation link to the first report page.</li>
                          </ul>
                        <li>Provide chart titles, one line where possible. Clear and descriptive ex: "Cost by Date"</li>
                        <li>Use rounded borders (8–12px) consistently.</li>
                        <li>Font sizes:</li>
                          <ul>
                            <li>Page Title: 18–24pt</li>
                            <li>Chart Titles: 14–16pt</li>
                            <li>Labels: 8–12pt</li>
                            <li>Minimum readable size recommended for body text: 12 pt. Ensure contrast rations are accessible.</li>
                          </ul>
                        <li>Color palette:</li>
                          <ul>
                            <li>Blue (primary)</li>
                            <li>Gray (secondary)</li>
                            <li>Red for alerts/warnings only</li>
                          </ul>
                      </ol>
                      <p>Download and import <a href="https://becarabia-my.sharepoint.com/:u:/p/karam_moukhtar/Ec2zA6lhk4hLucj1gm4TyW4BhvaSZ639ZABo0bsWuOxA2g?download=1">BEC Arabia Theme</a> as shown below 
                        <a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EZfEG4gdjCNNqpVw5nXwo1gBgcaMp-KC50kVhIhhFhvTWA?download=1">See Example</a>
                      </p>
                      <br>
                      <p>Below is a demo dashboard you can interact with to see the recommended layout for the landing page, colors, and navigation.</p>
                      <div class="figure"><iframe title="Template DB" width="1140" height="541.25" src="https://app.powerbi.com/reportEmbed?reportId=e3351375-ead5-4546-a6e3-98f797317b70&autoAuth=true&ctid=436fbbdf-64e4-42ee-b534-0bc16423c440" frameborder="0" allowFullScreen="true" style="width:100%;height:541.25px;border-radius:10px;display:block;"></iframe></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Report Publishing -->
            <div class="accordion-item">
              <div class="accordion-header"><h3>2. Report Publishing (Output)</h3><span>+</span></div>
              <div class="accordion-content">
                <div class="nested-accordion">
                  <div class="nested-accordion-item">
                    <div class="nested-accordion-header">
                      <h4>2.1 Publishing to a Unified Power BI Workspace</h4>
                      <span>+</span>
                    </div>
                    <div class="nested-accordion-content">
                      <p>Instead of having 2 Power BI workspaces like we explained <a href="#workspaces-reference">here</a> and to seek standerdization, Dashboards will be published to a centralized workspace set up by IT, with a folder structure for each department.<a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EVE7GItGZO9FkBZtP-Sr51IBoBXpKOsiSDYoJcLppWee2g?download=1">See Example</a></p>
                    </div>
                  </div>
                  
                  <div class="nested-accordion-item">
                    <div class="nested-accordion-header">
                      <h4>2.2 Scheduled Refresh Setup</h4>
                      <span>+</span>
                    </div>
                    <div class="nested-accordion-content">
                      <p>Refresh is scheduled to run at least twice daily (or more as required). Stakeholders are notified if refresh fails. <a href="#" class="open-image" data-img-src="https://becarabia-my.sharepoint.com/:i:/p/karam_moukhtar/EeRvUNrvVx1HkA_L3ZAd-A4BlMzU4zYLFKK-p17aPj6XKQ?download=1">See Example</a></p>
                    </div>
                  </div>
                  
                  <div class="nested-accordion-item">
                    <div class="nested-accordion-header">
                      <h4>2.3 Row-Level Security and User Access Setup</h4>
                      <span>+</span>
                    </div>
                    <div class="nested-accordion-content">
                      <p>RLS is configured and centrally managed by IT to ensure appropriate data access.</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
  </main>

  <footer class="footer">
    <p>&copy; 2025 BEC – BEC Reporting Guide - PCI</p>
  </footer>

  <!-- Back to Top Button -->
  <button class="backtop-btn" onclick="window.scrollTo({top:0,behavior:'smooth'});">↑</button>

  <!-- Accordion Controls -->
  <div class="accordion-controls">
    <button class="accordion-control-btn" onclick="expandAllAccordions()" title="Expand All">+</button>
    <button class="accordion-control-btn" onclick="collapseAllAccordions()" title="Collapse All">−</button>
  </div>

  <!-- Image Modal -->
  <div id="imageModal" class="modal">
    <span class="close" id="modalClose">&times;</span>
    <img class="modal-content" id="modalImage" alt="Expanded image">
  </div>

  <!-- Accordion JS -->
  <script>
    // Ensure page starts at top
    window.addEventListener('load', () => {
      // Expand accordions first so layout height is correct
      expandAllAccordions();
      // If a deep link (hash) exists, scroll to that section after layout settles
      if (location.hash) {
        const target = document.getElementById(location.hash.slice(1));
        if (target) {
          // Delay to allow expanded sections to compute heights
          setTimeout(() => {
            target.scrollIntoView({ behavior: 'auto', block: 'start' });
          }, 0);
        }
      } else {
        // Only force top when no hash is present
        window.scrollTo(0, 0);
      }
    });

    function setMaxHeight(element, isOpen) {
      if (!isOpen) {
        element.style.maxHeight = '0px';
        return;
      }
      element.style.maxHeight = 'none';
      const fullHeight = element.scrollHeight;
      element.style.maxHeight = fullHeight + 'px';
    }

    function recalcOpenAncestors(fromEl) {
      let parent = fromEl.parentElement;
      while (parent) {
        if ((parent.classList && parent.classList.contains('accordion-content')) ||
            (parent.classList && parent.classList.contains('nested-accordion-content'))) {
          if (parent.classList.contains('open')) {
            setMaxHeight(parent, true);
          }
        }
        parent = parent.parentElement;
      }
    }

    function toggleSection(header, content) {
      const willOpen = !content.classList.contains('open');
      content.classList.toggle('open');
      header.querySelector('span').textContent = willOpen ? '–' : '+';
      setMaxHeight(content, willOpen);
      // Recalculate ancestors immediately and after layout settles
      recalcOpenAncestors(content);
      requestAnimationFrame(() => recalcOpenAncestors(content));
      setTimeout(() => recalcOpenAncestors(content), 350);
    }

    // Main accordion functionality
    document.querySelectorAll('.accordion-header').forEach(header => {
      const content = header.nextElementSibling;
      setMaxHeight(content, content.classList.contains('open'));
      header.addEventListener('click', () => toggleSection(header, content));
    });

    // Nested accordion functionality
    document.querySelectorAll('.nested-accordion-header').forEach(header => {
      const content = header.nextElementSibling;
      setMaxHeight(content, content.classList.contains('open'));
      header.addEventListener('click', () => toggleSection(header, content));
    });

    // Recalculate heights for any open sections on resize
    window.addEventListener('resize', () => {
      document.querySelectorAll('.accordion-content.open, .nested-accordion-content.open').forEach(el => {
        setMaxHeight(el, true);
      });
    });

    // Expand all accordions
    function expandAllAccordions() {
      // Expand main accordions
      document.querySelectorAll('.accordion-content').forEach(content => {
        if (!content.classList.contains('open')) {
          const header = content.previousElementSibling;
          toggleSection(header, content);
        }
      });
      
      // Expand nested accordions
      document.querySelectorAll('.nested-accordion-content').forEach(content => {
        if (!content.classList.contains('open')) {
          const header = content.previousElementSibling;
          toggleSection(header, content);
        }
      });
    }

    // Collapse all accordions
    function collapseAllAccordions() {
      // Collapse nested accordions first
      document.querySelectorAll('.nested-accordion-content.open').forEach(content => {
        const header = content.previousElementSibling;
        toggleSection(header, content);
      });
      
      // Then collapse main accordions
      document.querySelectorAll('.accordion-content.open').forEach(content => {
        const header = content.previousElementSibling;
        toggleSection(header, content);
      });
    }
  </script>
  <script>
    // Restart GIF on hover for elements with class hover-gif
    (function(){
      const attachOncePerHover = (img) => {
        const original = img.getAttribute('data-gif-src') || img.src;
        let hasStarted = false;
        img.addEventListener('mouseenter', () => {
          if (hasStarted) return;
          hasStarted = true;
          // start flip animation once
          img.classList.add('gif-flip-once');
          // force restart by resetting src with cache buster once
          const url = original + (original.includes('?') ? '&' : '?') + 't=' + Date.now();
          img.src = url;
          // remove animation class after it completes to allow future re-use
          setTimeout(() => img.classList.remove('gif-flip-once'), 900);
        });
        img.addEventListener('mouseleave', () => {
          // allow restarting on next hover only after mouse leaves area
          hasStarted = false;
        });
      };
      document.querySelectorAll('img.hover-gif').forEach(attachOncePerHover);
    })();
  </script>
  <script>
    // Inline album navigation
    (function(){
      document.querySelectorAll('[data-album]').forEach(album => {
        const slides = Array.from(album.querySelectorAll('.album-slide'));
        const prev = album.querySelector('.album-nav.prev');
        const next = album.querySelector('.album-nav.next');
        const captionDisplay = album.querySelector('.album-caption-display');
        let index = slides.findIndex(s => s.classList.contains('active'));
        if (index < 0) index = 0;
        function show(i){
          slides.forEach((s, idx) => s.classList.toggle('active', idx === i));
          if (captionDisplay) {
            const captionEl = slides[i].querySelector('.album-caption');
            captionDisplay.textContent = captionEl ? captionEl.textContent : '';
          }
        }
        // initialize caption
        show(index);
        prev.addEventListener('click', () => {
          index = (index - 1 + slides.length) % slides.length;
          show(index);
        });
        next.addEventListener('click', () => {
          index = (index + 1) % slides.length;
          show(index);
        });
      });
    })();
  </script>
  <script>
    // Image modal behavior for all images (make every image clickable to magnify)
    (function(){
      const modal = document.getElementById('imageModal');
      const modalImg = document.getElementById('modalImage');
      const closeBtn = document.getElementById('modalClose');
      const body = document.body;
      if (!modal || !modalImg || !closeBtn) return;
      function openModal(src){
        if (!src) return;
        modal.style.display = 'block';
        modalImg.src = src;
        body.classList.add('modal-open');
      }
      function closeModal(){
        modal.style.display = 'none';
        modalImg.src = '';
        body.classList.remove('modal-open');
      }
      // 1) Links that explicitly request opening an image
      document.querySelectorAll('a.open-image').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const src = link.getAttribute('data-img-src') || link.getAttribute('href');
          openModal(src);
        });
      });
      // 2) Make all inline images clickable to open in modal (except logo and images inside the modal itself)
      document.querySelectorAll('img').forEach(img => {
        // Skip modal image, icons, or images that should not be clickable
        if (img.id === 'modalImage') return;
        // Add a visual cue class only to content images (not the logo in header)
        if (!img.classList.contains('clickable-image') && !img.closest('a')) {
          img.classList.add('clickable-image');
        }
        img.addEventListener('click', (e) => {
          // If the image is already wrapped in a link that is not image href, prevent navigation but open modal
          if (img.closest('a')) {
            e.preventDefault();
          }
          const src = img.getAttribute('data-img-src') || img.getAttribute('src');
          openModal(src);
        });
      });
      // 3) Ensure any album images use their data source as src so they display immediately
      document.querySelectorAll('.album-slide img[data-img-src]').forEach(img => {
        const ds = img.getAttribute('data-img-src');
        if (ds && (!img.getAttribute('src') || img.getAttribute('src') !== ds)) {
          img.setAttribute('src', ds);
        }
      });
      // Close interactions
      closeBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && modal.style.display === 'block') closeModal(); });
    })();
  </script>
</body>
</html>
